@startuml API_DataFlow_Discovery
left to right direction
skinparam componentStyle rectangle
skinparam wrapWidth 280
skinparam maxMessageSize 200
title Data Flow: Discovery & Route Endpoints

cloud "Overpass (OpenStreetMap)" as OSM
database "MongoDB" as DB

package "Endpoints: Discovery & Route" {
  top to bottom direction
  component "POST /api/locations"      as EP_LOCATIONS
  component "POST /api/discover-route" as EP_DISCOVER
  component "POST /api/generate-route" as EP_GENERATE
}

' READ = dotted green from source -> endpoint
DB  -[#2E7D32]-.-> EP_LOCATIONS : READ (exists?)
OSM -[#2E7D32]-.-> EP_DISCOVER  : READ (find pubs)
DB  -[#2E7D32]-.-> EP_GENERATE  : READ (bars for route)

' WRITE = solid red to DB
EP_LOCATIONS -[#C62828]-> DB : WRITE (save bar if new)
EP_DISCOVER  -[#C62828]-> DB : WRITE (save discovered bars)

@enduml
